!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/platform-browser"),require("@angular/forms")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/platform-browser","@angular/forms"],e):e(t.smstUtilityModule={},t.ng.core,t.ng.platformBrowser,t.ng.forms)}(this,function(t,o,e,i){"use strict";var n=function(){function t(){this.event=r.NOEVENT,this.locked=!1}return t.prototype.init=function(t){this.event=t,this.locked=!0},t.prototype.unlock=function(){this.event=r.NOEVENT,this.locked=!1},t.prototype.isLocked=function(t){return this.event===r.NOEVENT&&(this.event=t),this.locked&&this.event!==t},t}(),r={NOEVENT:0,PINCH:1,PAN:2,WHEEL:3,TAP:4,EXTERNAL:5};r[r.NOEVENT]="NOEVENT",r[r.PINCH]="PINCH",r[r.PAN]="PAN",r[r.WHEEL]="WHEEL",r[r.TAP]="TAP",r[r.EXTERNAL]="EXTERNAL";var s=function(){function t(t,e){this.render=t,this.elRef=e,this.zoomStep=.1,this.pinchStep=.03,this.currentZoom||(this.currentZoom=1),this.previousZoom=0,this.minZoom=1,this.maxZoom=2,this.zoomTargetId="zoomTarget",this.eventLock=new n,this.currentZoomChange=new o.EventEmitter,this.enableTabZoom=!1,this.disableZoom=!1}return t.prototype.onWheel=function(t){this.disableZoom||this.eventLock.isLocked(r.WHEEL)||t.ctrlKey&&(t.preventDefault(),this.eventLock.init(r.WHEEL),this.zoomPoint={x:t.x,y:t.y},this.zoomIntoContainer(t.deltaY<0?this.zoomPoint:this.getTargetCenter(),t.deltaY<0?this.zoomStep:-this.zoomStep),this.resetEventLockTimout())},t.prototype.onTouch=function(t){this.disableZoom||this.eventLock.isLocked(r.TAP)||this.enableTabZoom&&(t.preventDefault(),this.eventLock.init(r.TAP),this.zoomPoint={x:t.center.x,y:t.center.y},this.zoomIntoContainer(this.zoomPoint,-this.zoomStep),this.resetEventLockTimout())},t.prototype.onPinchIn=function(t){this.disableZoom||0===t.velocityY||this.eventLock.isLocked(r.PINCH)||(this.zoomPoint={x:t.center.x,y:t.center.y},this.zoomIntoContainer(this.zoomPoint,-this.pinchStep))},t.prototype.onPinchOut=function(t){this.disableZoom||0===t.velocityY||this.eventLock.isLocked(r.PINCH)||(this.zoomPoint={x:t.center.x,y:t.center.y},this.zoomIntoContainer(this.getTargetCenter(),this.pinchStep))},t.prototype.onTouchStart=function(t){this.disableZoom||(1<t.touches.length?this.eventLock.isLocked(r.PAN)||(this.eventLock.unlock(),this.eventLock.init(r.PINCH)):this.eventLock.isLocked(r.PAN)||(this.eventLock.init(r.PAN),this.zoomPoint={x:t.touches[0].clientX,y:t.touches[0].clientY}))},t.prototype.onTouchMove=function(t){if(!this.disableZoom&&!(this.zoomPoint.x<0||this.eventLock.isLocked(r.PAN))){var e={x:t.touches[0].clientX,y:t.touches[0].clientY};this.scroll("x",this.zoomPoint.x-e.x),this.scroll("y",this.zoomPoint.y-e.y),this.zoomPoint=e}},t.prototype.onTouchEnd=function(t){this.eventLock.unlock(),this.zoomPoint={x:-1,y:-1}},t.prototype.zoomIntoContainer=function(t,e,o){if(this.zoomTarget.firstElementChild){var i=(this.elRef.nativeElement.scrollLeft+this.getScrollHandleSize("x")/2)/this.elRef.nativeElement.scrollWidth,n=this.getScrollHandleSize("x"),r=(this.elRef.nativeElement.scrollTop+this.getScrollHandleSize("y")/2)/this.elRef.nativeElement.scrollHeight,s=this.getScrollHandleSize("y");if(this.setNewZoomLevel(e,o||!1)){this.render.setStyle(this.zoomTarget.firstElementChild,"transform-origin","0 0"),this.render.setStyle(this.zoomTarget.firstElementChild,"transform","scale("+this.currentZoom+")");this.elRef.nativeElement.clientWidth,this.zoomTarget.firstElementChild.getBoundingClientRect().width,this.elRef.nativeElement.clientHeight,this.zoomTarget.firstElementChild.getBoundingClientRect().height;var h=0,c=0;h=this.elRef.nativeElement.scrollWidth*i-this.getScrollHandleSize("x")/2+2*(n-this.getScrollHandleSize("x")),c=this.elRef.nativeElement.scrollHeight*r-this.getScrollHandleSize("y")/2+2*(s-this.getScrollHandleSize("y"));var l=this.getCenterDeviation(this.getTargetCenter(),t,e);this.elRef.nativeElement.scrollLeft=h+l.x,this.elRef.nativeElement.scrollTop=c+l.y,this.currentZoomChange.emit(this.currentZoom)}}},t.prototype.getScrollHandleSize=function(t){return"x"===t?this.elRef.nativeElement.getBoundingClientRect().width/this.zoomTarget.firstElementChild.getBoundingClientRect().width*this.elRef.nativeElement.clientWidth:this.elRef.nativeElement.getBoundingClientRect().height/this.zoomTarget.firstElementChild.getBoundingClientRect().height*this.elRef.nativeElement.clientHeight},t.prototype.setNewZoomLevel=function(t,e){if(this.currentZoom=e?this.currentZoom:this.currentZoom+=t,this.currentZoom<this.minZoom){if(this.currentZoom=this.minZoom,this.previousZoom===this.currentZoom)return!1}else if(this.currentZoom>this.maxZoom&&(this.currentZoom=this.maxZoom,this.previousZoom===this.currentZoom))return!1;return this.previousZoom=this.currentZoom,!0},t.prototype.getTargetCenter=function(){var t=this.elRef.nativeElement.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}},t.prototype.getCenterDeviation=function(t,e,o){var i=this;if(this.eventLock.isLocked(r.WHEEL))return{x:0,y:0};if(this.zoomPointLockTimeout&&clearTimeout(this.zoomPointLockTimeout),this.zoomPointLockTimeout=setTimeout(function(){i.zoomPointLocked=!1},500),!this.zoomPointLocked){this.zoomPointLocked=!0;var n=(this.maxZoom-this.currentZoom)/o;n=0===n?1:n,this.currentDeviation={x:(e.x-t.x)/n,y:(e.y-t.y)/n}}return this.currentDeviation},t.prototype.scroll=function(t,e){switch(t){case"y":this.elRef.nativeElement.scrollTop+=e;break;case"x":this.elRef.nativeElement.scrollLeft+=e}},t.prototype.defineZoomTarget=function(){this.zoomTarget=document.getElementById(this.zoomTargetId),this.zoomTarget||console.error("SmStUtilityModule - ZoomDirective: ","zoomTarget could not be initiated. ","zoomTargetId = ",this.zoomTargetId)},t.prototype.resetEventLockTimout=function(){var t=this;this.eventLockResetTimout&&clearTimeout(this.eventLockResetTimout),this.eventLockResetTimout=setTimeout(function(){t.eventLock.unlock()},500)},t.prototype.ngOnInit=function(){this.zoomTarget=document.getElementById(this.zoomTargetId)},t.prototype.ngOnChanges=function(t){t.zoomTargetId&&this.defineZoomTarget(),t.currentZoom&&(this.zoomTarget||this.defineZoomTarget(),this.eventLock.isLocked(r.EXTERNAL)||(this.eventLock.init(r.EXTERNAL),this.zoomIntoContainer(this.getTargetCenter(),t.currentZoom.currentValue-(t.currentZoom.previousValue||1),!0),this.resetEventLockTimout())),t.disableZoom&&this.eventLock.unlock()},t}();s.decorators=[{type:o.Directive,args:[{selector:"[smstZoom]"}]}],s.ctorParameters=function(){return[{type:o.Renderer2},{type:o.ElementRef}]},s.propDecorators={minZoom:[{type:o.Input,args:["minZoom"]}],maxZoom:[{type:o.Input,args:["maxZoom"]}],zoomTargetId:[{type:o.Input,args:["zoomTargetId"]}],currentZoom:[{type:o.Input,args:["currentZoom"]}],enableTabZoom:[{type:o.Input,args:["enableTabZoom"]}],disableZoom:[{type:o.Input,args:["disableZoom"]}],currentZoomChange:[{type:o.Output,args:["currentZoomChange"]}],onWheel:[{type:o.HostListener,args:["wheel",["$event"]]}],onTouch:[{type:o.HostListener,args:["tap",["$event"]]}],onPinchIn:[{type:o.HostListener,args:["pinchin",["$event"]]}],onPinchOut:[{type:o.HostListener,args:["pinchout",["$event"]]}],onTouchStart:[{type:o.HostListener,args:["touchstart",["$event"]]}],onTouchMove:[{type:o.HostListener,args:["touchmove",["$event"]]}],onTouchEnd:[{type:o.HostListener,args:["touchend",["$event"]]}]};var h=function(){};h.decorators=[{type:o.NgModule,args:[{declarations:[s],imports:[e.BrowserModule,i.FormsModule],providers:[],bootstrap:[],exports:[s]}]}],h.ctorParameters=function(){return[]},t.SmStUtilityModule=h,t.Éµa=s,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=smstUtilityModule.umd.min.js.map
