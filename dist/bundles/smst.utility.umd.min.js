!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core")):"function"==typeof define&&define.amd?define(["exports","@angular/core"],e):e((t.smst=t.smst||{},t.smst.utility={}),t.ng.core)}(this,function(t,e){"use strict";var o=function(){function t(t,e){this.render=t,this.elRef=e,this.zoomStep=.1,this.pinchStep=.05,this.currentZoom=1,this.previousZoom=0,this.minZoom=1,this.maxZoom=2,this.zoomTargetId="zoomTarget"}return t.prototype.onWheel=function(t){if(t.ctrlKey){t.preventDefault();var e=this.getContainerRatios();this.zoomPoint={x:t.x,y:t.y},this.zoomIntoContainer(this.zoomPoint,e,t.deltaY<0?this.zoomStep:-this.zoomStep)}},t.prototype.onPinchIn=function(t){if(0!==t.velocityY){var e=this.getContainerRatios();this.zoomPoint={x:t.center.x,y:t.center.y},this.zoomIntoContainer(this.zoomPoint,e,-this.pinchStep)}},t.prototype.onPinchOut=function(t){if(0!==t.velocityY){var e=this.getContainerRatios();this.zoomPoint={x:t.center.x,y:t.center.y},this.zoomIntoContainer(this.zoomPoint,e,this.pinchStep)}},t.prototype.getContainerRatios=function(){(this.zoomTarget.getBoundingClientRect().height<1||this.zoomTarget.getBoundingClientRect().width<1)&&this.fitTargetContainerToContents();var t,e;return this.zoomTarget.getBoundingClientRect().height>this.zoomTarget.getBoundingClientRect().width?(t=1,e=this.zoomTarget.getBoundingClientRect().width/this.zoomTarget.getBoundingClientRect().height):(t=this.zoomTarget.getBoundingClientRect().height/this.zoomTarget.getBoundingClientRect().width,e=1),{x:t,y:e}},t.prototype.zoomIntoContainer=function(t,e,o){var i={right:this.zoomTarget.firstElementChild.getBoundingClientRect().right-this.zoomPoint.x,bottom:this.zoomTarget.firstElementChild.getBoundingClientRect().bottom-this.zoomPoint.y};if(this.setNewZoomLevel(o)){this.render.setStyle(this.zoomTarget.firstElementChild,"transform-origin","0 0"),this.render.setStyle(this.zoomTarget.firstElementChild,"transform","scale("+this.currentZoom+")"),this.fitTargetContainerToContents();var n={right:this.zoomTarget.firstElementChild.getBoundingClientRect().right-this.zoomPoint.x,bottom:this.zoomTarget.firstElementChild.getBoundingClientRect().bottom-this.zoomPoint.y},r=(this.elRef.nativeElement.scrollLeft+this.getScrollHandleSize("x"))/this.elRef.nativeElement.scrollWidth,s=(this.elRef.nativeElement.scrollTop+this.getScrollHandleSize("y"))/this.elRef.nativeElement.scrollHeight,h=(n.right-i.right)*r,m=(n.bottom-i.bottom)*s;this.elRef.nativeElement.scrollLeft+=h+this.getCenterDeviation(this.getTargetCenter(),t,e,o).x,this.elRef.nativeElement.scrollTop+=m+this.getCenterDeviation(this.getTargetCenter(),t,e,o).y}},t.prototype.getScrollHandleSize=function(t){return"x"===t?this.elRef.nativeElement.clientWidth/(this.zoomTarget.clientWidth/this.elRef.nativeElement.clientWidth):this.elRef.nativeElement.clientHeight/(this.zoomTarget.clientHeight/this.elRef.nativeElement.clientHeight)},t.prototype.setNewZoomLevel=function(t){if(this.currentZoom+=t,this.currentZoom<this.minZoom){if(this.currentZoom=this.minZoom,this.previousZoom===this.currentZoom)return!1}else if(this.currentZoom>this.maxZoom&&(this.currentZoom=this.maxZoom,this.previousZoom===this.currentZoom))return!1;return this.previousZoom=this.currentZoom,!0},t.prototype.getTargetCenter=function(){var t=this.elRef.nativeElement.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}},t.prototype.getCenterDeviation=function(t,e,o,i){var n=this;if(this.zoomPointLockTimeout&&clearTimeout(this.zoomPointLockTimeout),this.zoomPointLockTimeout=setTimeout(function(){n.zoomPointLocked=!1},1e3),!this.zoomPointLocked){this.zoomPointLocked=!0;var r=(this.maxZoom-this.currentZoom)/i;this.currentDeviation={x:(e.x-t.x)/r,y:(e.y-t.y)/r}}return this.currentDeviation},t.prototype.fitTargetContainerToContents=function(){this.render.setStyle(this.zoomTarget,"width",this.zoomTarget.firstElementChild.clientWidth+"px"),this.render.setStyle(this.zoomTarget,"height",this.zoomTarget.firstElementChild.clientHeight+"px")},t.prototype.ngOnInit=function(){this.zoomTarget=document.getElementById(this.zoomTargetId)},t.prototype.ngOnChanges=function(t){t.zoomTargetId&&(this.zoomTarget=document.getElementById(this.zoomTargetId))},t.decorators=[{type:e.Directive,args:[{selector:"[smstZoom]"}]}],t.ctorParameters=function(){return[{type:e.Renderer2},{type:e.ElementRef}]},t.propDecorators={minZoom:[{type:e.Input,args:["minZoom"]}],maxZoom:[{type:e.Input,args:["maxZoom"]}],zoomTargetId:[{type:e.Input,args:["zoomTargetId"]}],onWheel:[{type:e.HostListener,args:["wheel",["$event"]]}],onPinchIn:[{type:e.HostListener,args:["pinchin",["$event"]]}],onPinchOut:[{type:e.HostListener,args:["pinchout",["$event"]]}]},t}(),i=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{declarations:[o],imports:[],providers:[],bootstrap:[],exports:[o]}]}],t.ctorParameters=function(){return[]},t}();t.SmStUtilityModule=i,t.SmStZoomDirective=o,Object.defineProperty(t,"__esModule",{value:!0})});