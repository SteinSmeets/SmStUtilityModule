!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("@angular/core")):"function"==typeof define&&define.amd?define(["exports","@angular/core"],o):o((t.smst=t.smst||{},t.smst.utility={}),t.ng.core)}(this,function(t,o){"use strict";var e=function(){function t(t,o){this.render=t,this.elRef=o,this.zoomStep=.1,this.pinchStep=.05,this.currentZoom=1,this.previousZoom=0,this.minZoom=1,this.maxZoom=2,this.zoomTargetId="zoomTarget"}return t.prototype.onWheel=function(t){if(t.ctrlKey){t.preventDefault();var o=this.getContainerRatios();this.zoomPoint={x:t.x,y:t.y},this.zoomIntoContainer(this.zoomPoint,o,t.deltaY<0?this.zoomStep:-this.zoomStep)}},t.prototype.onTouch=function(t){t.preventDefault();var o=this.getContainerRatios();this.zoomPoint={x:t.center.x,y:t.center.y},this.zoomIntoContainer(this.zoomPoint,o,-this.zoomStep)},t.prototype.onPinchIn=function(t){if(0!==t.velocityY){var o=this.getContainerRatios();this.zoomPoint={x:t.center.x,y:t.center.y},this.zoomIntoContainer(this.zoomPoint,o,-this.pinchStep)}},t.prototype.onPinchOut=function(t){if(0!==t.velocityY){var o=this.getContainerRatios();this.zoomPoint={x:t.center.x,y:t.center.y},this.zoomIntoContainer(this.zoomPoint,o,this.pinchStep)}},t.prototype.getContainerRatios=function(){var t,o;return this.zoomTarget.getBoundingClientRect().height>this.zoomTarget.getBoundingClientRect().width?(t=this.zoomTarget.getBoundingClientRect().width/this.zoomTarget.getBoundingClientRect().height,o=1):(t=1,o=this.zoomTarget.getBoundingClientRect().height/this.zoomTarget.getBoundingClientRect().width),{x:t,y:o}},t.prototype.zoomIntoContainer=function(t,o,e){var i={right:this.zoomTarget.getBoundingClientRect().right-this.zoomPoint.x,bottom:this.zoomTarget.getBoundingClientRect().bottom-this.zoomPoint.y};if(this.setNewZoomLevel(e)){this.render.setStyle(this.zoomTarget.firstElementChild,"transform-origin","0 0"),this.render.setStyle(this.zoomTarget.firstElementChild,"transform","scale("+this.currentZoom+")"),this.render.setStyle(this.zoomTarget,"width",this.zoomTarget.firstElementChild.getBoundingClientRect().width+"px"),this.render.setStyle(this.zoomTarget,"height",this.zoomTarget.firstElementChild.getBoundingClientRect().height+"px");var n={right:this.zoomTarget.getBoundingClientRect().right-this.zoomPoint.x,bottom:this.zoomTarget.getBoundingClientRect().bottom-this.zoomPoint.y},r=1-o.x||.5,s=1-o.y||.5,h=(n.right-i.right)*r,m=(n.bottom-i.bottom)*s;this.elRef.nativeElement.scrollLeft+=h+this.getCenterDeviation(this.getTargetCenter(),t,this.getContainerRatios(),e).x,this.elRef.nativeElement.scrollTop+=m+this.getCenterDeviation(this.getTargetCenter(),t,this.getContainerRatios(),e).y}},t.prototype.setNewZoomLevel=function(t){if(this.currentZoom+=t,this.currentZoom<this.minZoom){if(this.currentZoom=this.minZoom,this.previousZoom===this.currentZoom)return!1}else if(this.currentZoom>this.maxZoom&&(this.currentZoom=this.maxZoom,this.previousZoom===this.currentZoom))return!1;return this.previousZoom=this.currentZoom,!0},t.prototype.getTargetCenter=function(){var t=this.elRef.nativeElement.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}},t.prototype.getCenterDeviation=function(t,o,e,i){var n=this;if(this.zoomPointLockTimeout&&clearTimeout(this.zoomPointLockTimeout),this.zoomPointLockTimeout=setTimeout(function(){n.zoomPointLocked=!1},1e3),!this.zoomPointLocked){this.zoomPointLocked=!0;var r=(this.maxZoom-this.currentZoom)/i;this.currentDeviation={x:(o.x-t.x)/r,y:(o.y-t.y)/r}}return this.currentDeviation},t.prototype.ngOnInit=function(){this.zoomTarget=document.getElementById(this.zoomTargetId)},t.prototype.ngOnChanges=function(t){t.zoomTargetId&&(this.zoomTarget=document.getElementById(this.zoomTargetId))},t.decorators=[{type:o.Directive,args:[{selector:"[smstZoom]"}]}],t.ctorParameters=function(){return[{type:o.Renderer2},{type:o.ElementRef}]},t.propDecorators={minZoom:[{type:o.Input,args:["minZoom"]}],maxZoom:[{type:o.Input,args:["maxZoom"]}],zoomTargetId:[{type:o.Input,args:["zoomTargetId"]}],onWheel:[{type:o.HostListener,args:["wheel",["$event"]]}],onTouch:[{type:o.HostListener,args:["tap",["$event"]]}],onPinchIn:[{type:o.HostListener,args:["pinchin",["$event"]]}],onPinchOut:[{type:o.HostListener,args:["pinchout",["$event"]]}]},t}(),i=function(){function t(){}return t.decorators=[{type:o.NgModule,args:[{declarations:[e],imports:[],providers:[],bootstrap:[],exports:[e]}]}],t.ctorParameters=function(){return[]},t}();t.SmStUtilityModule=i,t.SmStZoomDirective=e,Object.defineProperty(t,"__esModule",{value:!0})});