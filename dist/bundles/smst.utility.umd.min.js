!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("@angular/core")):"function"==typeof define&&define.amd?define(["exports","@angular/core"],o):o((t.smst=t.smst||{},t.smst.utility={}),t.ng.core)}(this,function(t,o){"use strict";var e=function(){function t(t,o){this.render=t,this.elRef=o,this.zoomStep=.1,this.pinchStep=.05,this.currentZoom=1,this.previousZoom=0,this.minZoom=1,this.maxZoom=2,this.zoomTargetId="zoomTarget"}return t.prototype.onWheel=function(t){if(t.ctrlKey){t.preventDefault();var o=this.getContainerRatios();this.zoomPoint={x:t.x,y:t.y},this.zoomIntoContainer(this.zoomPoint,o,t.deltaY<0?this.zoomStep:-this.zoomStep)}},t.prototype.onTouch=function(t){t.preventDefault();var o=this.getContainerRatios();this.zoomPoint={x:t.center.x,y:t.center.y},this.zoomIntoContainer(this.zoomPoint,o,this.zoomStep)},t.prototype.onPinchIn=function(t){if(0!==t.velocityY){var o=this.getContainerRatios();this.zoomPoint={x:t.center.x,y:t.center.y},this.zoomIntoContainer(this.zoomPoint,o,-this.pinchStep)}},t.prototype.onPinchOut=function(t){if(0!==t.velocityY){var o=this.getContainerRatios();this.zoomPoint={x:t.center.x,y:t.center.y},this.zoomIntoContainer(this.zoomPoint,o,this.pinchStep)}},t.prototype.getContainerRatios=function(){var t,o;return this.elRef.nativeElement.scrollWidth>this.elRef.nativeElement.scrollHeight?(t=1,o=this.elRef.nativeElement.scrollHeight/this.elRef.nativeElement.scrollWidth):(t=this.elRef.nativeElement.scrollWidth/this.elRef.nativeElement.scrollHeight,o=1),{x:t,y:o}},t.prototype.zoomIntoContainer=function(t,o,e){var i={right:this.zoomTarget.getBoundingClientRect().right-this.zoomPoint.x,bottom:this.zoomTarget.getBoundingClientRect().bottom-this.zoomPoint.y};if(this.setNewZoomLevel(e)){this.render.setStyle(this.zoomTarget,"transform","scale("+this.currentZoom+")");var n={right:this.zoomTarget.getBoundingClientRect().right-this.zoomPoint.x,bottom:this.zoomTarget.getBoundingClientRect().bottom-this.zoomPoint.y},r=(n.right-i.right)/this.maxZoom,s=(n.bottom-i.bottom)/this.maxZoom;this.elRef.nativeElement.scrollLeft+=r+this.getCenterDeviation(this.getTargetCenter(),t,this.getContainerRatios(),e).x,this.elRef.nativeElement.scrollTop+=s+this.getCenterDeviation(this.getTargetCenter(),t,this.getContainerRatios(),e).y}},t.prototype.setNewZoomLevel=function(t){if(this.currentZoom+=t,this.currentZoom<this.minZoom){if(this.currentZoom=this.minZoom,this.previousZoom===this.currentZoom)return!1}else if(this.currentZoom>this.maxZoom&&(this.currentZoom=this.maxZoom,this.previousZoom===this.currentZoom))return!1;return this.previousZoom=this.currentZoom,!0},t.prototype.getTargetCenter=function(){var t=this.elRef.nativeElement.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}},t.prototype.getCenterDeviation=function(t,o,e,i){var n=this;if(this.zoomPointLockTimeout&&clearTimeout(this.zoomPointLockTimeout),this.zoomPointLockTimeout=setTimeout(function(){n.zoomPointLocked=!1},1e3),!this.zoomPointLocked){this.zoomPointLocked=!0;var r=(this.maxZoom-this.currentZoom)/i;this.currentDeviation={x:(o.x-t.x)/r,y:(o.y-t.y)/r}}return this.currentDeviation},t.prototype.ngOnInit=function(){this.zoomTarget=document.getElementById(this.zoomTargetId)},t.prototype.ngOnChanges=function(t){t.zoomTargetId&&(this.zoomTarget=document.getElementById(this.zoomTargetId))},t.decorators=[{type:o.Directive,args:[{selector:"[toiZoom]"}]}],t.ctorParameters=function(){return[{type:o.Renderer2},{type:o.ElementRef}]},t.propDecorators={minZoom:[{type:o.Input,args:["minZoom"]}],maxZoom:[{type:o.Input,args:["maxZoom"]}],zoomTargetId:[{type:o.Input,args:["zoomTargetId"]}],onWheel:[{type:o.HostListener,args:["wheel",["$event"]]}],onTouch:[{type:o.HostListener,args:["tap",["$event"]]}],onPinchIn:[{type:o.HostListener,args:["pinchin",["$event"]]}],onPinchOut:[{type:o.HostListener,args:["pinchout",["$event"]]}]},t}(),i=function(){function t(){}return t.decorators=[{type:o.NgModule,args:[{declarations:[e],imports:[],providers:[],bootstrap:[],exports:[e]}]}],t.ctorParameters=function(){return[]},t}();t.SmStUtilityModule=i,t.ZoomDirective=e,Object.defineProperty(t,"__esModule",{value:!0})});